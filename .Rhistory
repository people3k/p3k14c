geom_point()+
labs(x= expression("Count Arch. Sites per"~KM^2),
y= expression("Count 14C Dates per"~KM^2),
subtitle = " (10S-15N; 17W-20E)")+
ggtitle("Western Africa Countries")+
geom_text(aes(label = ifelse(nSites > 300,Country, NA)),  hjust=1.1, vjust=0.4)+
# scale_x_continuous(limits = c(0, 370))+
theme_bw()+
theme(
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
plot.title = element_text(size = 14))+
geom_abline(data = smaSummaryWAfr ,
aes(intercept = elevation,
slope = slope),
color = "red") +
geom_text(data = smaSummaryWAfr,
aes(x = 0, y = Inf,
label = paste("Y = ", round(slope,2), "x +", round(elevation,2))),
hjust = 0,
vjust = 2,
color = "red") +
geom_text(data = smaSummaryWAfr,
aes(x = 0, y = Inf,
label = paste("p =",
ifelse(pval <0.00001, "< 0.00001",
round(pval, 6)))),
hjust = 0,
vjust = 4,
color = "red")
GGWAfr
GGWAfr <- ggplot(data=WAfr,
aes(
x= nSitesPerKM2,
y= nDatesPerKM2
)) +
geom_point()+
labs(x= expression("Count Arch. Sites per"~KM^2),
y= expression("Count 14C Dates per"~KM^2),
subtitle = " (10S-15N; 17W-20E)")+
ggtitle("Western Africa Countries")+
# geom_text(aes(label = ifelse(nSites > 300,Country, NA)),  hjust=1.1, vjust=0.4)+
# scale_x_continuous(limits = c(0, 370))+
theme_bw()+
theme(
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
plot.title = element_text(size = 14))+
geom_abline(data = smaSummaryWAfr ,
aes(intercept = elevation,
slope = slope),
color = "red") +
geom_text(data = smaSummaryWAfr,
aes(x = 0, y = Inf,
label = paste("Y = ", round(slope,2), "x +", round(elevation,2))),
hjust = 0,
vjust = 2,
color = "red") +
geom_text(data = smaSummaryWAfr,
aes(x = 0, y = Inf,
label = paste("p =",
ifelse(pval <0.00001, "< 0.00001",
round(pval, 6)))),
hjust = 0,
vjust = 4,
color = "red")
GGWAfr
GGWAfr <- ggplot(data=WAfr,
aes(
x= nSitesPerKM2,
y= nDatesPerKM2
)) +
geom_point()+
labs(x= expression("Count Arch. Sites per"~KM^2),
y= expression("Count 14C Dates per"~KM^2),
subtitle = " (10S-15N; 17W-20E)")+
ggtitle("Western Africa Countries")+
geom_text(aes(label = ifelse(nSitesPerKM2 > 0.0003,Country, NA)),  hjust=1.1, vjust=0.4)+
# scale_x_continuous(limits = c(0, 370))+
theme_bw()+
theme(
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
plot.title = element_text(size = 14))+
geom_abline(data = smaSummaryWAfr ,
aes(intercept = elevation,
slope = slope),
color = "red") +
geom_text(data = smaSummaryWAfr,
aes(x = 0, y = Inf,
label = paste("Y = ", round(slope,2), "x +", round(elevation,2))),
hjust = 0,
vjust = 2,
color = "red") +
geom_text(data = smaSummaryWAfr,
aes(x = 0, y = Inf,
label = paste("p =",
ifelse(pval <0.00001, "< 0.00001",
round(pval, 6)))),
hjust = 0,
vjust = 4,
color = "red")
GGWAfr
WSA <- RC %>%
dplyr::filter(Country %in% c("Chile", "Peru", "Bolivia", "Argentina")) %>%
# dplyr::filter(
#   Lat >= WSABounds$Lat_min & Lat <= WSABounds$Lat_max,
#   Long >= WSABounds$Long_min & Long <= WSABounds$Long_max
# )  %>%
dplyr::group_by(Country, guessed_province) %>%
dplyr::count() %>%
dplyr::ungroup() %>%
dplyr::mutate(nDates = n) %>%
dplyr::select(-n) %>%
dplyr::left_join(WSASites) %>%
dplyr::mutate(Country = as.factor(Country)) %>%
left_join(
provinces
)
WSA <- RC %>%
dplyr::filter(Country %in% c("Chile", "Peru", "Bolivia", "Argentina")) %>%
# dplyr::filter(
#   Lat >= WSABounds$Lat_min & Lat <= WSABounds$Lat_max,
#   Long >= WSABounds$Long_min & Long <= WSABounds$Long_max
# )  %>%
dplyr::group_by(Country, guessed_province) %>%
dplyr::count() %>%
dplyr::ungroup() %>%
dplyr::mutate(nDates = n) %>%
dplyr::select(-n) %>%
dplyr::left_join(WSASites) %>%
dplyr::mutate(Country = as.factor(Country)) %>%
left_join(
provinces %>% dplyr::rename("guessed_province" = "province")
)
WSA <- RC %>%
dplyr::filter(Country %in% c("Chile", "Peru", "Bolivia", "Argentina")) %>%
# dplyr::filter(
#   Lat >= WSABounds$Lat_min & Lat <= WSABounds$Lat_max,
#   Long >= WSABounds$Long_min & Long <= WSABounds$Long_max
# )  %>%
dplyr::group_by(Country, guessed_province) %>%
dplyr::count() %>%
dplyr::ungroup() %>%
dplyr::mutate(nDates = n) %>%
dplyr::select(-n) %>%
dplyr::left_join(WSASites) %>%
dplyr::mutate(Country = as.factor(Country)) %>%
left_join(
provinces %>% dplyr::rename("guessed_province" = "Province")
)
WSA <- RC %>%
dplyr::filter(Country %in% c("Chile", "Peru", "Bolivia", "Argentina")) %>%
# dplyr::filter(
#   Lat >= WSABounds$Lat_min & Lat <= WSABounds$Lat_max,
#   Long >= WSABounds$Long_min & Long <= WSABounds$Long_max
# )  %>%
dplyr::group_by(Country, guessed_province) %>%
dplyr::count() %>%
dplyr::ungroup() %>%
dplyr::mutate(nDates = n) %>%
dplyr::select(-n) %>%
dplyr::left_join(WSASites) %>%
dplyr::mutate(Country = as.factor(Country)) %>%
left_join(
provinces %>% dplyr::rename("guessed_province" = "Province")
) %>%
dplyr::mutate(
nSitesPerKM2 = nSites / area_sqkm,
nDatesPerKM2 = nDates / area_sqkm
)
SMAResultsWSA <- sma((nDatesPerKM2)~(nSitesPerKM2), WSA)
summary(SMAResultsWSA)
smaSummaryWSA <- coef(SMAResultsWSA) %>%
t() %>%
as.data.frame() %>%
dplyr::mutate(pval = as.numeric(SMAResultsWSA$pval))
GGWSA <- ggplot(data=WSA,
aes(
x= nSitesPerKM2,
y= nDatesPerKM2
))+
geom_point(aes(shape = Country))+
labs(x= expression("Count Arch. Sites per"~KM^2),
y= expression("Count 14C Dates per"~KM^2))+
ggtitle("SW South American Provinces")+
# geom_text(aes(label = Country),  hjust=-0.1, vjust=0.4)+
# scale_x_continuous(limits = c(0, 30))+
theme_bw()+
theme(
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
plot.title = element_text(size = 14),
legend.position = c(0.8, 0.2),
legend.title = element_blank())+
geom_abline(data = smaSummaryWSA ,
aes(intercept = elevation,
slope = slope),
color = "red") +
geom_text(data = smaSummaryWSA,
aes(x = 0, y = Inf,
label = paste("Y = ", round(slope,2), "x +", round(elevation,2))),
hjust = 0,
vjust = 2,
color = "red") +
geom_text(data = smaSummaryWSA,
aes(x = 0, y = Inf,
label = paste("p =",
ifelse(pval <0.00001, "< 0.00001",
round(pval, 6)))),
hjust = 0,
vjust = 4,
color = "red")
GGWSA
##### Global patchwork =======
ppi <-  180
png("globallinearQualAnalysis.png", width=6.5*ppi, height=8*ppi, res=ppi)
ggarrange(GGChina ,
GGWAfr,
GGWEur,
GGWSA,
labels = c("A", "B", "C", "D"),
ncol = 2, nrow = 2)
dev.off()
GGWAfr <- ggplot(data=WAfr,
aes(
x= nSitesPerKM2,
y= nDatesPerKM2
)) +
geom_point()+
labs(x= expression("Count Arch. Sites per"~KM^2),
y= expression("Count 14C Dates per"~KM^2),
subtitle = " (10S-15N; 17W-20E)")+
ggtitle("Western Africa Countries")+
geom_text(aes(label = ifelse(nSitesPerKM2 > 0.00035,Country, NA)),  hjust=1.1, vjust=0.4)+
# scale_x_continuous(limits = c(0, 370))+
theme_bw()+
theme(
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
plot.title = element_text(size = 14))+
geom_abline(data = smaSummaryWAfr ,
aes(intercept = elevation,
slope = slope),
color = "red") +
geom_text(data = smaSummaryWAfr,
aes(x = 0, y = Inf,
label = paste("Y = ", round(slope,2), "x +", round(elevation,2))),
hjust = 0,
vjust = 2,
color = "red") +
geom_text(data = smaSummaryWAfr,
aes(x = 0, y = Inf,
label = paste("p =",
ifelse(pval <0.00001, "< 0.00001",
round(pval, 6)))),
hjust = 0,
vjust = 4,
color = "red")
GGWAfr
GGWEur <- ggplot(data=WEur,
aes(
x= nSitesPerKM2,
y= nDatesPerKM2
))+
geom_point()+
labs(x= expression("Count Arch. Sites per"~KM^2),
y= expression("Count 14C Dates per"~KM^2))+
ggtitle("Western Europe Countries")+
ggrepel::geom_text_repel(aes(label = ifelse(nSitesPerKM2 > 0.00035,Country, NA)),  hjust=-0.1, vjust=0.4)+
ifelse(nSitesPerKM2 > 0.02,Country, NA)
GGWEur <- ggplot(data=WEur,
aes(
x= nSitesPerKM2,
y= nDatesPerKM2
))+
geom_point()+
labs(x= expression("Count Arch. Sites per"~KM^2),
y= expression("Count 14C Dates per"~KM^2))+
ggtitle("Western Europe Countries")+
ggrepel::geom_text_repel(aes(label = ifelse(nSitesPerKM2 > 0.02,Country, NA)),  hjust=-0.1, vjust=0.4)+
# scale_x_continuous(limits = c(0, 5500))+
theme_bw()+
theme(
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
plot.title = element_text(size = 14))+
geom_abline(data = smaSummaryWEur ,
aes(intercept = elevation,
slope = slope),
color = "red") +
geom_text(data = smaSummaryWEur,
aes(x = 0, y = Inf,
label = paste("Y = ", round(slope,2), "x +", round(elevation,2))),
hjust = 0,
vjust = 2,
color = "red")+
geom_text(data = smaSummaryWEur,
aes(x = 0, y = Inf,
label = paste("p =",
ifelse(pval <0.00001, "< 0.00001",
round(pval, 5)))),
hjust = 0,
vjust = 4,
color = "red")
GGWEur
GGWSA <- ggplot(data=WSA,
aes(
x= nSitesPerKM2,
y= nDatesPerKM2
))+
geom_point(aes(shape = Country))+
labs(x= expression("Count Arch. Sites per"~KM^2),
y= expression("Count 14C Dates per"~KM^2))+
ggtitle("SW South American Provinces")+
# geom_text(aes(label = Country),  hjust=-0.1, vjust=0.4)+
# scale_x_continuous(limits = c(0, 30))+
theme_bw()+
theme(
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
plot.title = element_text(size = 14),
legend.position = c(0.75, 0.2),
legend.title = element_blank())+
geom_abline(data = smaSummaryWSA ,
aes(intercept = elevation,
slope = slope),
color = "red") +
geom_text(data = smaSummaryWSA,
aes(x = 0, y = Inf,
label = paste("Y = ", round(slope,2), "x +", round(elevation,2))),
hjust = 0,
vjust = 2,
color = "red") +
geom_text(data = smaSummaryWSA,
aes(x = 0, y = Inf,
label = paste("p =",
ifelse(pval <0.00001, "< 0.00001",
round(pval, 6)))),
hjust = 0,
vjust = 4,
color = "red")
GGWSA
##### Global patchwork =======
ppi <-  180
png("globallinearQualAnalysis.png", width=6.5*ppi, height=8*ppi, res=ppi)
ggarrange(GGChina ,
GGWAfr,
GGWEur,
GGWSA,
labels = c("A", "B", "C", "D"),
ncol = 2, nrow = 2)
dev.off()
#### BAD GLOBAL COUNTIES ----
RC_county3 <- RC_county2 %>%
filter(is.na(Regional),
!is.na(Guessed_subprovince),
is.na(as.numeric(Guessed_subprovince)))
GGWAfr <- ggplot(data=WAfr,
aes(
x= nSitesPerKM2,
y= nDatesPerKM2
)) +
geom_point()+
labs(x= expression("Count Arch. Sites per"~KM^2),
y= expression("Count 14C Dates per"~KM^2),
subtitle = " (10S-15N; 17W-20E)")+
ggtitle("Western Africa Countries")+
geom_text(aes(label = ifelse(nDatesPerKM2 > 0.00075,Country, NA)),  hjust=1.1, vjust=0.4)+
# scale_x_continuous(limits = c(0, 370))+
theme_bw()+
theme(
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
plot.title = element_text(size = 14))+
geom_abline(data = smaSummaryWAfr ,
aes(intercept = elevation,
slope = slope),
color = "red") +
geom_text(data = smaSummaryWAfr,
aes(x = 0, y = Inf,
label = paste("Y = ", round(slope,2), "x +", round(elevation,2))),
hjust = 0,
vjust = 2,
color = "red") +
geom_text(data = smaSummaryWAfr,
aes(x = 0, y = Inf,
label = paste("p =",
ifelse(pval <0.00001, "< 0.00001",
round(pval, 6)))),
hjust = 0,
vjust = 4,
color = "red")
GGWAfr
##### Global patchwork =======
ppi <-  180
png("globallinearQualAnalysis.png", width=6.5*ppi, height=8*ppi, res=ppi)
ggarrange(GGChina ,
GGWAfr,
GGWEur,
GGWSA,
labels = c("A", "B", "C", "D"),
ncol = 2, nrow = 2)
dev.off()
View(China)
GGChxina <- ggplot(data=China,
aes(
x= nSitesPerKM2,
y= nDatesPerKM2
)) +
geom_point()+
labs(x= expression("Count Arch. Sites per"~KM^2),
y= expression("Count 14C Dates per"~KM^2))+
ggtitle("China Provinces")+
ggrepel::geom_text_repel(aes(label = ifelse(nDatesPerKM2 > 0.003  , Province, NA )),  hjust=-0.1, vjust=0.4)+
# scale_x_continuous(limits = c(0,8000))+
theme_bw()+
theme(
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
plot.title = element_text(size = 14))+
geom_abline(data = smaSummaryChina ,
aes(intercept = elevation,
slope = slope),
color = "red") +
geom_text(data = smaSummaryChina,
aes(x = 0, y = Inf,
label = paste("Y = ", round(slope,2), "x +", round(elevation,2))),
hjust = 0,
vjust = 4,
color = "red")+
geom_text(data = smaSummaryChina,
aes(x = 0, y = Inf,
label = paste("p =",
ifelse(pval <0.00001, "< 0.00001",
round(pval, 5)))),
hjust = 0,
vjust = 6,
color = "red")
GGChina <- ggplot(data=China,
aes(
x= nSitesPerKM2,
y= nDatesPerKM2
)) +
geom_point()+
labs(x= expression("Count Arch. Sites per"~KM^2),
y= expression("Count 14C Dates per"~KM^2))+
ggtitle("China Provinces")+
ggrepel::geom_text_repel(aes(label = ifelse(nDatesPerKM2 > 0.003  , Province, NA )),  hjust=-0.1, vjust=0.4)+
# scale_x_continuous(limits = c(0,8000))+
theme_bw()+
theme(
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
plot.title = element_text(size = 14))+
geom_abline(data = smaSummaryChina ,
aes(intercept = elevation,
slope = slope),
color = "red") +
geom_text(data = smaSummaryChina,
aes(x = 0, y = Inf,
label = paste("Y = ", round(slope,2), "x +", round(elevation,2))),
hjust = 0,
vjust = 4,
color = "red")+
geom_text(data = smaSummaryChina,
aes(x = 0, y = Inf,
label = paste("p =",
ifelse(pval <0.00001, "< 0.00001",
round(pval, 5)))),
hjust = 0,
vjust = 6,
color = "red")
##### Global patchwork =======
ppi <-  180
png("globallinearQualAnalysis.png", width=6.5*ppi, height=8*ppi, res=ppi)
ggarrange(GGChina ,
GGWAfr,
GGWEur,
GGWSA,
labels = c("A", "B", "C", "D"),
ncol = 2, nrow = 2)
dev.off()
usethis::use_gpl3_license()
usethis::use_package("devtools", type = "suggests")
usethis::use_package("readr")
usethis::use_package("tibble")
usethis::use_package("dplyr")
usethis::use_package("sf")
usethis::use_package("tidyr")
usethis::use_package("sparr")
usethis::use_package("spatstat")
